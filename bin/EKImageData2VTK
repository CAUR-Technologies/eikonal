#!/usr/bin/env python

from evtk.hl import imageToVTK 
import numpy as np
from glob import glob
import os
from optparse import OptionParser

parser = OptionParser(usage='%prog [options] infile(npy format) outfile(vti format) ')
parser.add_option("-t", "--type", default='P',
                  help = 'Velocity type (P or S)')

(opts, args) = parser.parse_args()

infile = args[0] # .split('.')[0] + '.npy'
outfile = args[1] # .split('.')[0]

tp = opts.type

try:
    Vel = np.load(infile)
except:
    print 'Unable to open %s' %infile
    exit()


[ny,nx,nz] = np.array(Vel.shape)
N = np.array(Vel.shape)
spcg = Vel.spacing
(ox,oy,oz) = tuple(np.array(Vel.origin))


vel_key = 'Vel_%s' %tp

imageToVTK(outfile,
           origin=(ox,oy,oz),
           spacing=(spcg,spcg,spcg),
           cellData = {vel_key: Vel.data})





